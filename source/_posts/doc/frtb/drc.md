---
layout:     post
title:      frtb
date:       2020-02-23
author:     geo
catalog: true
tags:
    - Python
    - Financial
---
<!-- 

可使用下述程式碼把markdown格式轉成word
```
pandoc -o output.docx -f markdown -t docx input.md
```
 -->

# 违约风险费用计量(DRC)

- 违约风险资本计量旨在捕捉敏感度方法资本计量中无法由信用利差风险捕捉的违约风险(Jump-todefault Risk) 

Remark : 为了捕捉突发风险

- 违约风险资本计量范围包括非证券化、证券化（非关联交易组合）、证券化（关联交易组合）三类产品的违约风险，捕捉由于违约造成的极度损失的风险

Remark : 所以要计算3种不同类型的drc , drc 提供了一些限制性的对冲效应

大致上的步骤 : 

1. Gross JTD 突发违约总头寸风险

2. Net JTD 突发违约净头寸风险

3. HBR ，Hedge benefit ratio 对冲效益比例

3. DRC ， default risk captial 违约风险资本要求

## 抵消与对冲

- 抵消（offsetting）是指对同一债务人的风险敞口的净额结算，在此情况下，空头头寸可直接从多头头寸中全部减去进行抵消；

- 对冲（hedging）是指不同债务人的风险敞口可能存在的一些对冲收益，不同债务人之间由于基差风险或相关性风险无法直接进行抵消，但可进行部分对冲。对冲识别在风险组别间是被允许的，风险类别间（即非证券化、证券化-非关联交易组合、证券化-关联交易组合之间）不能存在风险分散化效应。

## 计算步骤：

1. 分别计算每个风险暴露的总违约风险Gross JTD；JTD 总额是违约损失率 （LGD）、名义金额（或面值）和已实现头寸的累计损益 `(P&L)` 的函数

2. 对于同一债务人，空头头寸和多头头寸的违约风险在允许的情况下可以抵消，从而得到每位债务人的净多头头寸或净空头头寸Net JTD，净违约风险头寸分配到不同的风险组别中；

3. 在一个风险组别中，由净多头和净空头的违约风险头寸计算对冲收益率，作为折扣因子减少风险组别内被净多头头寸抵消的净空头头寸；

4. 简单加总各风险组别内的违约风险资本要求，得到整体违约风险资本要求。

# 非证券化违约风险资本计量

首先要判断多头与空头的标准 :

多空头寸的判定不是以买入或卖出来决定，而是以当参考实体违约时信用风险敞口
的损益方向来决定。当某信用风险敞口由于参考实体的违约造成损失时，该敞口被
认定为多头头寸。

例如 : **商业银行卖出的某债券看跌期权,视为其有多头风险敞口暴露**,因为参考实体的违约将导致商业银行遭受损失。

## Gross JTD

$$JTD_{long} = max(LGD * N + P\&L,0)$$

$$JTD_{short} = min(LGD * N + P\&L,0)$$

其中: 

$N$

> 名目本金 , 名义本金

$P&L$

> 为头寸的累计盯市损益 , $P&L = market value − notional$

$LGD$

> 违约损失率

> 权益工具和非优先债务工具(或者叫做非高级债务工具)的LGD为100%

> 优先债务工具的LGD为75%

> 资产担保债券的LGD为25%

> 若金融工具的价格与违约方的回收率(Recovery Rate)不相关时，不必将名义本金与LGD相乘 , 例如现金流为欧元多头票息与美元空头票息互换的汇率信贷混合期权 , 带有在特定债务人违约事件发生时会终止现金流的条款

## Net JTD

对同一债务人而言，当违约风险的空头头寸相对于多头头寸具有相同或更低的优先权时，可进行JTD金额的抵消。

例如，股权空头头寸可以抵消债券多头头寸，但债券空头头寸不可抵消股权多头头寸:

$$net\ JTD = Bond_{long} - Equity_{short}$$

抵消后，可得出对应不同债务人名称的Net JTD结果。分为净多头风险暴露$net\ JTD_{long}$和净空头风险暴露 $net\ JTD_{short}$

非证券化违约风险有3个风险组别，分别如下：

- 公司

- 主权国家

- 地方政府和市政机构

不同风险组别之间的风险分散化效应不被认可，但每个风险组别内部可识别一些对冲收益。每个风险组别具有一个对冲收益率（hedge benefit ratio/HBR)，用于确认该风险组别内多头头寸和空头头寸的对冲收益。

某风险组别的对冲收益率（HBR）计算方法如下：
第一步：选取该风险组别内所有违约风险净多头头寸，简单进行加总，得到$\sum net\ JTD_{long}$

第二步：选取该该风险组别内所有违约风险净空头头寸，简单进行加总，得到$\sum net\ JTD_{short}$

第三步：HBR为净多头风险头寸加总除以净多头风险头寸和净空头风险头寸绝对值之和

$$HBR=\frac{\sum{net\ JTD_{long}}}{\sum{net\ JTD_{long}+\sum |\ net\ JTD_{short} \ |}}$$

信用等级区分的非证券化产品违约风险权重

信用等级 | 违约风险权重 
:------: | :---------: 
AAA | 0.5%
AA | 2%
A | 3%
BBB | 6% 
BB | 15%
B | 30%
CCC | 50%
未评级 | 15%
default | 100%
|

$$DRC_b = max\bigg\{ (\sum_{i \in long}RW_i * net\ JTD_j) - HBR * (\sum_{i \in short}RW_i * |\ net JTD_i|)\, ;0\bigg\}$$

其中:

$b$ 

> 风险组别

$RW_i$

> 债务人i的信用等级分配的违约风险权重

不同风险组别间的违约风险分散化效应不被认可，非证券化产品的总违约风险资本为不同风险组别资本要求的简单加总:

$$DRC = DRC_a + DRC_b +DRC_c$$

# 证券化-非关联交易组合违约风险资本计量(non-CTP)

## Gross JTD

证券化-非关联交易组合产品总违约风险敞口的风险头寸Gross JTD计算规则与非证券
化产品相同，但因该产品中违约损失率LGD已包含在证券化风险暴露的违约风险权重
中,故不再重复计算`LGD（LGD=0）`

具体计算公式如下：

$$JTD=Market\ Value$$

## Net JTD
对于证券化-非关联交易组合，以下两种情况的证券化风险暴露不可抵消：

- 不同基础资产池的证券化投资组合产品；

- 同一证券化投资组合产品的不同层级

## HBR

证券化-非关联交易组合违约风险有2个风险组别，分别如下：

- 所有地区的公司（不包含中小企业）；

- 其他组别，包含亚洲、欧洲、北美洲及其他地区的11个资产类别：资产支持商业
票据、汽车贷款/租赁、住房贷款抵押证券、信用卡、商业房地产抵押贷款支持证
券、贷款抵押债券、担保债务凭证再证券化、中小企业贷款、学生贷款、其他零
售贷款和其他贷款。

不同风险组别之间的风险分散化效应不被认可，但每个风险组别内部可识别一些对冲
收益。每个风险组别具有一个对冲收益率，用于确认该风险组别内多头头寸和空头头
寸的对冲收益。

对冲收益率的计算方法与非证券化产品对冲收益率计算方法相同

$$HBR=\frac{\sum{net\ JTD_{long}}}{\sum{net\ JTD_{long}+\sum |\ net\ JTD_{short} \ |}}$$

DRC 计算公式 : 

$$DRC_b=\max\bigg\{(\sum_{i\in long}RW_i * net\ JTD_i)-HBR * (\sum_{i\in short} RW_i * |net\ JTD_i|)\; ,0\bigg\}$$

# 证券化-关联交易组合违约风险资本计量 (CTP)

## Gross JTD

同证券化-非关联交易组合

## Net JTD

对于证券化-关联交易组合，以下两种情况的证券化风险暴露不可抵消：
（1）不同指数；
（2）相同指数的不同系列
（3）相同指数或系列的证券化产品的不同层级。
当两个证券化-关联交易组合产品除剩余期限外，其他属性（指数类型、序列、层级）都相同时，其证券化风险暴
露Gross JTD可进行抵消，抵消收益的期限调整方式同非证券化产品（见4.1.2章节）。此外，分解后可完全复制的
多头和空头风险暴露可进行抵消。

## HBR
证券化-关联交易组合违约风险按照指数类型划分风险组别，目前可列举的风险组别（指数类型）包括：

- CDX 北美洲 IG；

- iTraxx 欧洲 IG；

- CDX HY；

- iTraxx XO;

- LCDX;

- iTraxx LevX;

- 亚洲指数；

- 拉丁美洲指数；

- 其他地区指数；

- 主要主权国家指数（G7和西欧）；

- 其他主权国家指数

证券化-关联交易组合的对冲收益率用于调整风险组别下的净空头头寸。该对冲收益率由所有风险组别内的多头头
寸和空头头寸来计算

$$HBR=\frac{\sum{net\ JTD_{long}}}{\sum{net\ JTD_{long}+\sum |\ net\ JTD_{short} \ |}}$$

因为证券化资产违约风险资本无零资本下限 , 因此指数层面的违约风险资本要求可能为负数

$$DRC_b=(\sum_{i\in long}RW_i * net\ JTD_i)-HBR_{ctp} * (\sum_{i\in short} RW_i * |net\ JTD_i|)$$

$$DRC_{CTP}=\max\bigg\{(\sum_{b}(\max[ DRC_b,0 ]+0.5*\min[ DRC_b,0 ])\; ,0\bigg\}$$

例如 : CDX 北美洲 IG指数的违约风险资本要求 +100 ，发达国家指数 (G7和西欧)的违约风险资本要求 -100 

可得 $100-0.5*100 = 50$